"use strict";(self.webpackChunkem_guide_app=self.webpackChunkem_guide_app||[]).push([[1802],{61802:(k,A,s)=>{s.r(A),s.d(A,{ProfilePage:()=>oe});var e=s(56940),d=s(75937),j=s(84319),I=s(22512),T=s(95984),y=s(54997),O=s(58400),u=s(65094),g=s(66041),R=s(74065),C=s(78054),_=s(11674),H=s(87773),q=s(93788),D=s(10798),i=s(30956),ee=s(30454),K=s(5799),Z=s(70789),se=s(24926),ae=s(28829),$=s(41480),S=s(48288),b=s(40829),z=s(19681),te=s(42052),Q=s(88720),X=s(63355),re=s(31819),we=s(66086),Ae=s(88193),je=s(8232),Ie=s(5337),Te=s(4357),ye=s(93484),Re=s(32635),Ce=s(67620),Se=s(71999),Ue=s(4549),Be=s(333),We=s(21709),Ke=s(21633),Ze=s(85845),be=s(78712);const ne=te.Ry().shape(re.s),oe=()=>{const{changeLocale:a,localeNames:l}=(0,Q.M)(),{setUserDisplayName:c}=(0,i.useAppInfo)(),{formatMessage:t}=(0,S.Z)(),{trackUsage:n}=(0,i.useTracking)(),p=(0,i.useNotification)(),{lockApp:o,unlockApp:x}=(0,i.useOverlayBlocker)(),{notifyStatus:L}=(0,j.G)(),{currentTheme:N,themes:f,onChangeTheme:h}=(0,Q.P)(),{get:Y,put:ce}=(0,i.useFetchClient)();(0,i.useFocusWhenNavigate)();const{isLoading:me,data:v,refetch:ue}=(0,b.useQuery)("user",async()=>{const{data:r}=await Y("/admin/users/me");return r.data},{onSuccess(){L(t({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError(){p({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),{isLoading:_e,data:ge}=(0,b.useQuery)(["providers","isSSOLocked"],async()=>{const{data:{data:r}}=await Y("/admin/providers/isSSOLocked");return r},{enabled:window.strapi.isEE&&window.strapi.features.isEnabled("sso"),onError(){p({type:"warning",message:{id:"Settings.permissions.users.sso.provider.error"}})}}),pe=me||_e,J=(0,b.useMutation)(async r=>{const{confirmPassword:M,currentTheme:E,...P}=r;let m=P;if((B=>"password"in B)(m)&&m.password===""){const{password:B,currentPassword:W,...G}=m;m=G}const{data:w}=await ce("/admin/users/me",m);return{...w.data,currentTheme:E}},{async onSuccess(r){await ue();const{email:M,firstname:E,lastname:P,username:m,preferedLanguage:U}=r;i.auth.setUserInfo({email:M,firstname:E,lastname:P,username:m,preferedLanguage:U});const w=r.username||(0,X.g)(r.firstname??"",r.lastname);c(w),r.preferedLanguage&&a(r.preferedLanguage),h(r.currentTheme),n("didChangeMode",{newMode:r.currentTheme}),p({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})},async onSettled(){x()}}),{isLoading:fe}=J,he=async(r,{setErrors:M})=>{o();const E=r.username;J.mutate({...r,username:E},{onError(P){const m=P?.response?.data;return m?.data?M(m.data):p({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})};if(pe||!v)return(0,e.jsxs)(I.o,{"aria-busy":"true",children:[(0,e.jsx)($.q,{title:t({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,e.jsx)(T.T,{title:t({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),(0,e.jsx)(y.D,{children:(0,e.jsx)(i.LoadingIndicatorPage,{})})]});const Ee=ge?.isSSOLocked??!1,{email:Pe,firstname:Me,lastname:Oe,username:De,preferedLanguage:xe}=v,Le={email:Pe,firstname:Me,lastname:Oe,username:De,preferedLanguage:xe,currentTheme:N,confirmPassword:"",password:""};return(0,e.jsxs)(I.o,{"aria-busy":fe,children:[(0,e.jsx)($.q,{title:t({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,e.jsx)(se.Formik,{onSubmit:he,initialValues:Le,validateOnChange:!1,validationSchema:ne,enableReinitialize:!0,children:({errors:r,values:{email:M,firstname:E,lastname:P,username:m,preferedLanguage:U,currentTheme:w,...B},handleChange:W,isSubmitting:G,dirty:ve})=>(0,e.jsxs)(i.Form,{children:[(0,e.jsx)(T.T,{title:v.username||(0,X.g)(v.firstname??"",v.lastname),primaryAction:(0,e.jsx)(O.z,{startIcon:(0,e.jsx)(ee.Z,{}),loading:G,type:"submit",disabled:!ve,children:t({id:"global.save",defaultMessage:"Save"})})}),(0,e.jsx)(u.x,{paddingBottom:10,children:(0,e.jsx)(y.D,{children:(0,e.jsxs)(g.k,{direction:"column",alignItems:"stretch",gap:6,children:[(0,e.jsx)(le,{errors:r,onChange:W,values:{firstname:E,lastname:P,username:m,email:M}}),!Ee&&(0,e.jsx)(ie,{errors:r,onChange:W,values:B}),(0,e.jsx)(de,{allApplicationThemes:f,onChange:W,values:{preferedLanguage:U,currentTheme:w},localeNames:l})]})})})]})})]})},ie=({errors:a,onChange:l,values:c})=>{const{formatMessage:t}=(0,S.Z)(),[n,p]=d.useState(!1),[o,x]=d.useState(!1),[L,N]=d.useState(!1);return(0,e.jsx)(u.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(g.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsx)(R.Z,{variant:"delta",as:"h2",children:t({id:"global.change-password",defaultMessage:"Change password"})}),(0,e.jsx)(C.r,{gap:5,children:(0,e.jsx)(_.P,{s:12,col:6,children:(0,e.jsx)(H.o,{error:a.currentPassword?t({id:a.currentPassword,defaultMessage:a.currentPassword}):"",onChange:l,value:c.currentPassword,label:t({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:n?"text":"password",endAction:(0,e.jsx)(F,{onClick:f=>{f.stopPropagation(),p(h=>!h)},label:t(n?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:n?(0,e.jsx)(K.Z,{}):(0,e.jsx)(Z.Z,{})})})})}),(0,e.jsxs)(C.r,{gap:5,children:[(0,e.jsx)(_.P,{s:12,col:6,children:(0,e.jsx)(V,{error:a.password?t({id:a.password,defaultMessage:a.password}):"",onChange:l,value:c.password,label:t({id:"global.password",defaultMessage:"Password"}),name:"password",type:o?"text":"password",autoComplete:"new-password",endAction:(0,e.jsx)(F,{onClick:f=>{f.stopPropagation(),x(h=>!h)},label:t(o?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:o?(0,e.jsx)(K.Z,{}):(0,e.jsx)(Z.Z,{})})})}),(0,e.jsx)(_.P,{s:12,col:6,children:(0,e.jsx)(V,{error:a.confirmPassword?t({id:a.confirmPassword,defaultMessage:a.confirmPassword}):"",onChange:l,value:c.confirmPassword,label:t({id:"Auth.form.confirmPassword.label",defaultMessage:"Confirm Password"}),name:"confirmPassword",type:L?"text":"password",autoComplete:"new-password",endAction:(0,e.jsx)(F,{onClick:f=>{f.stopPropagation(),N(h=>!h)},label:t(L?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:L?(0,e.jsx)(K.Z,{}):(0,e.jsx)(Z.Z,{})})})})]})]})})},V=(0,z.default)(H.o)`
  ::-ms-reveal {
    display: none;
  }
`,F=(0,z.default)(q.E)`
  svg {
    height: ${(0,i.pxToRem)(16)};
    width: ${(0,i.pxToRem)(16)};
    path {
      fill: ${({theme:a})=>a.colors.neutral600};
    }
  }
`,de=({onChange:a,values:l,localeNames:c,allApplicationThemes:t={}})=>{const{formatMessage:n}=(0,S.Z)(),p=Object.keys(t).filter(o=>t[o]);return(0,e.jsx)(u.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(g.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsxs)(g.k,{direction:"column",alignItems:"stretch",gap:1,children:[(0,e.jsx)(R.Z,{variant:"delta",as:"h2",children:n({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})}),(0,e.jsx)(R.Z,{children:n({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:(0,e.jsx)(u.x,{as:"a",color:"primary600",target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales",children:n({id:"Settings.profile.form.section.experience.here",defaultMessage:"here"})})})})]}),(0,e.jsxs)(C.r,{gap:5,children:[(0,e.jsx)(_.P,{s:12,col:6,children:(0,e.jsx)(D.q4,{label:n({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:n({id:"global.select",defaultMessage:"Select"}),hint:n({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{a({target:{name:"preferedLanguage",value:null}})},clearLabel:n({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:l.preferedLanguage,onChange:o=>{a({target:{name:"preferedLanguage",value:o}})},children:Object.entries(c).map(([o,x])=>(0,e.jsx)(D.ag,{value:o,children:x},o))})}),(0,e.jsx)(_.P,{s:12,col:6,children:(0,e.jsxs)(D.q4,{label:n({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:n({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:n({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:l.currentTheme,onChange:o=>{a({target:{name:"currentTheme",value:o}})},children:[(0,e.jsx)(D.ag,{value:"system",children:n({id:"Settings.profile.form.section.experience.mode.option-system-label",defaultMessage:"Use system settings"})}),p.map(o=>(0,e.jsx)(D.ag,{value:o,children:n({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:n({id:o,defaultMessage:ae(o)})})},o))]})})]})]})})},le=({errors:a,onChange:l,values:c})=>{const{formatMessage:t}=(0,S.Z)();return(0,e.jsx)(u.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(g.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsx)(R.Z,{variant:"delta",as:"h2",children:t({id:"global.profile",defaultMessage:"Profile"})}),(0,e.jsxs)(C.r,{gap:5,children:[(0,e.jsx)(_.P,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:a.firstname,onChange:l,value:c.firstname,type:"text",name:"firstname",required:!0})}),(0,e.jsx)(_.P,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:a.lastname,onChange:l,value:c.lastname,type:"text",name:"lastname"})}),(0,e.jsx)(_.P,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:a.email,onChange:l,value:c.email,type:"email",name:"email",required:!0})}),(0,e.jsx)(_.P,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:a.username,onChange:l,value:c.username,type:"text",name:"username"})})]})]})})}},31819:(k,A,s)=>{s.d(A,{a:()=>y,s:()=>I});var e=s(42052),d=s(30956);const j={firstname:e.Z_().trim().required(d.translatedErrors.required),lastname:e.Z_(),email:e.Z_().email(d.translatedErrors.email).lowercase().required(d.translatedErrors.required),username:e.Z_().nullable(),password:e.Z_().min(8,d.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Z_().min(8,d.translatedErrors.minLength).oneOf([e.iH("password"),null],"components.Input.error.password.noMatch").when("password",(O,u)=>O?u.required(d.translatedErrors.required):u)},I={...j,currentPassword:e.Z_().when(["password","confirmPassword"],(O,u,g)=>O||u?g.required(d.translatedErrors.required):g),preferedLanguage:e.Z_().nullable()},T={roles:e.IX().min(1,d.translatedErrors.required).required(d.translatedErrors.required)},y=e.Ry().shape({...j,isActive:e.Xg(),...T})}}]);
