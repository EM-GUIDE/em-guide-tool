"use strict";(self.webpackChunkem_guide_app=self.webpackChunkem_guide_app||[]).push([[9450],{30120:(v,M,t)=>{t.d(M,{D:()=>D});var s=t(56940),e=t(65094),E=t(26488);function m(g,l,d){if(!g||!l||!d)return{display:"none"};const{x:f,y:n}=d;return{transform:`translate(${f}px, ${n}px)`}}const D=({renderItem:g})=>{const{itemType:l,isDragging:d,item:f,initialOffset:n,currentOffset:c,mouseOffset:_}=(0,E.useDragLayer)(i=>({item:i.getItem(),itemType:i.getItemType(),initialOffset:i.getInitialSourceClientOffset(),currentOffset:i.getSourceClientOffset(),isDragging:i.isDragging(),mouseOffset:i.getClientOffset()}));return d?(0,s.jsx)(e.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%",children:(0,s.jsx)(e.x,{style:m(n,c,_),children:g({type:l,item:f})})}):null}},3878:(v,M,t)=>{t.d(M,{B:()=>W,D:()=>p,H:()=>j,R:()=>B});var s=t(56940),e=t(66041),E=t(74065),m=t(53917),D=t(22512),g=t(54997),l=t(95984),d=t(30956),f=t(70754),n=t(31941),c=t(48288),_=t(30120),i=t(50086),P=t(14025),a=t(19681);const L=(0,a.default)(e.k)`
  svg path {
    fill: ${({theme:O})=>O.colors.neutral600};
  }
`;function T({name:O}){return(0,s.jsxs)(e.k,{background:"primary100",borderStyle:"dashed",borderColor:"primary600",borderWidth:"1px",gap:3,hasRadius:!0,padding:3,shadow:"tableShadow",width:(0,d.pxToRem)(300),children:[(0,s.jsx)(L,{alignItems:"center",background:"neutral200",borderRadius:"50%",height:6,justifyContent:"center",width:6,children:(0,s.jsx)(f.Z,{width:`${8/16}rem`})}),(0,s.jsx)(E.Z,{fontWeight:"bold",children:O})]})}T.propTypes={name:P.string.isRequired};function R({type:O,item:u}){switch(O){case i.D.STAGE:return(0,s.jsx)(T,{...u});default:return null}}function p(){return(0,s.jsx)(_.D,{renderItem:R})}function B({children:O}){return(0,s.jsx)(m.A,{children:(0,s.jsx)(D.o,{tabIndex:-1,children:(0,s.jsx)(g.D,{children:O})})})}function W({href:O}){const{formatMessage:u}=(0,c.Z)();return(0,s.jsx)(d.Link,{startIcon:(0,s.jsx)(n.Z,{}),to:O,children:u({id:"global.back",defaultMessage:"Back"})})}function j({title:O,subtitle:u,navigationAction:w,primaryAction:x}){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.SettingsPageTitle,{name:O}),(0,s.jsx)(l.T,{navigationAction:w,primaryAction:x,title:O,subtitle:u})]})}},59450:(v,M,t)=>{t.r(M),t.d(M,{default:()=>Y});var s=t(56940),e=t(30956),E=t(93484),m=t(63355),D=t(75937),g=t(66041),l=t(39738),d=t(19493),f=t(95207),n=t(2986),c=t(94684),_=t(44773),i=t(74065),P=t(31220),a=t(84093),L=t(24091),T=t(7047),R=t(95227),p=t(68333),B=t(48288),W=t(40829),j=t(82018),O=t(19681),u=t(62128),w=t(74089),x=t(3878),K=t(86857),h=t(50086),V=t(63037),gt=t(21633),Dt=t(85845),Mt=t(88720),ft=t(66086),Ot=t(88193),mt=t(8232),Pt=t(5337),ut=t(4357),Ct=t(41480),vt=t(24926),Tt=t(32635),ht=t(42052),yt=t(67620),Lt=t(71999),xt=t(4549),At=t(333),It=t(21709),Rt=t(78712),pt=t(30120);const G=(0,O.default)(e.Link)`
  align-items: center;
  height: ${(0,e.pxToRem)(32)};
  display: flex;
  justify-content: center;
  padding: ${({theme:o})=>`${o.spaces[2]}}`};
  width: ${(0,e.pxToRem)(32)};

  svg {
    height: ${(0,e.pxToRem)(12)};
    width: ${(0,e.pxToRem)(12)};

    path {
      fill: ${({theme:o})=>o.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:o})=>o.colors.neutral800};
      }
    }
  }
`;function J(){const{formatMessage:o}=(0,B.Z)(),{push:Z}=(0,j.k6)(),{collectionTypes:X,singleTypes:b,isLoading:q}=(0,u.u)(),{meta:y,workflows:k,isLoading:U,refetch:tt}=(0,V.u)(),[F,S]=D.useState(null),[st,A]=D.useState(!1),{del:et}=(0,e.useFetchClient)(),{formatAPIError:nt}=(0,e.useAPIErrorHandler)(),N=(0,e.useNotification)(),{getFeature:at,isLoading:H}=(0,w.u)(),{trackUsage:Q}=(0,e.useTracking)(),ot=(0,E.useSelector)(m.s),{allowedActions:{canCreate:z,canDelete:it}}=(0,e.useRBAC)(ot.settings["review-workflows"]),C=at("review-workflows"),{mutateAsync:rt,isLoading:_t}=(0,W.useMutation)(async({workflowId:r,stages:I})=>{const{data:{data:$}}=await et(`/admin/review-workflows/workflows/${r}`,{data:I});return $},{onSuccess(){N({type:"success",message:{id:"notification.success.deleted",defaultMessage:"Deleted"}})}}),lt=r=>[...X,...b].find($=>$.uid===r).info.displayName,dt=r=>{S(r)},Et=()=>{S(null)},ct=async()=>{try{const r=await rt({workflowId:F});return await tt(),S(null),r}catch(r){return N({type:"warning",message:nt(r)}),null}};return D.useEffect(()=>{!U&&!H&&C?.[h.C]&&y?.workflowCount>parseInt(C[h.C],10)&&A(!0)},[H,U,C,y?.workflowCount,y.workflowsTotal]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.H,{primaryAction:z&&(0,s.jsx)(e.LinkButton,{startIcon:(0,s.jsx)(T.Z,{}),size:"S",to:"/settings/review-workflows/create",onClick:r=>{C?.[h.C]&&y?.workflowCount>=parseInt(C[h.C],10)?(r.preventDefault(),A(!0)):Q("willCreateWorkflow")},children:o({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})}),subtitle:o({id:"Settings.review-workflows.list.page.subtitle",defaultMessage:"Manage your content review process"}),title:o({id:"Settings.review-workflows.list.page.title",defaultMessage:"Review Workflows"})}),(0,s.jsxs)(x.R,{children:[U||q?(0,s.jsx)(g.k,{justifyContent:"center",children:(0,s.jsx)(l.a,{children:o({id:"Settings.review-workflows.page.list.isLoading",defaultMessage:"Workflows are loading"})})}):(0,s.jsxs)(d.i,{colCount:3,footer:z&&(0,s.jsx)(f.c,{icon:(0,s.jsx)(T.Z,{}),onClick:()=>{C?.[h.C]&&y?.workflowCount>=parseInt(C[h.C],10)?A(!0):(Z("/settings/review-workflows/create"),Q("willCreateWorkflow"))},children:o({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})}),rowCount:1,children:[(0,s.jsx)(n.h,{children:(0,s.jsxs)(c.Tr,{children:[(0,s.jsx)(_.Th,{children:(0,s.jsx)(i.Z,{variant:"sigma",children:o({id:"Settings.review-workflows.list.page.list.column.name.title",defaultMessage:"Name"})})}),(0,s.jsx)(_.Th,{children:(0,s.jsx)(i.Z,{variant:"sigma",children:o({id:"Settings.review-workflows.list.page.list.column.stages.title",defaultMessage:"Stages"})})}),(0,s.jsx)(_.Th,{children:(0,s.jsx)(i.Z,{variant:"sigma",children:o({id:"Settings.review-workflows.list.page.list.column.contentTypes.title",defaultMessage:"Content Types"})})}),(0,s.jsx)(_.Th,{children:(0,s.jsx)(P.T,{children:o({id:"Settings.review-workflows.list.page.list.column.actions.title",defaultMessage:"Actions"})})})]})}),(0,s.jsx)(a.p,{children:k.map(r=>(0,D.createElement)(c.Tr,{...(0,e.onRowClick)({fn(I){I.target.nodeName!=="BUTTON"&&Z(`/settings/review-workflows/${r.id}`)}}),key:`workflow-${r.id}`},(0,s.jsx)(_.Td,{width:(0,e.pxToRem)(250),children:(0,s.jsx)(i.Z,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0,children:r.name})}),(0,s.jsx)(_.Td,{children:(0,s.jsx)(i.Z,{textColor:"neutral800",children:r.stages.length})}),(0,s.jsx)(_.Td,{children:(0,s.jsx)(i.Z,{textColor:"neutral800",children:(r?.contentTypes??[]).map(lt).join(", ")})}),(0,s.jsx)(_.Td,{children:(0,s.jsxs)(g.k,{alignItems:"center",justifyContent:"end",children:[(0,s.jsx)(G,{to:`/settings/review-workflows/${r.id}`,"aria-label":o({id:"Settings.review-workflows.list.page.list.column.actions.edit.label",defaultMessage:"Edit {name}"},{name:r.name}),children:(0,s.jsx)(R.Z,{})}),k.length>1&&it&&(0,s.jsx)(L.h,{"aria-label":o({id:"Settings.review-workflows.list.page.list.column.actions.delete.label",defaultMessage:"Delete {name}"},{name:"Default workflow"}),icon:(0,s.jsx)(p.Z,{}),noBorder:!0,onClick:()=>{dt(r.id)}})]})})))})]}),(0,s.jsx)(e.ConfirmDialog,{bodyText:{id:"Settings.review-workflows.list.page.delete.confirm.body",defaultMessage:"If you remove this worfklow, all stage-related information will be removed for this content-type. Are you sure you want to remove it?"},isConfirmButtonLoading:_t,isOpen:!!F,onToggleDialog:Et,onConfirm:ct}),(0,s.jsxs)(K.L,{isOpen:st,onClose:()=>A(!1),children:[(0,s.jsx)(K.T,{children:o({id:"Settings.review-workflows.list.page.workflows.limit.title",defaultMessage:"You\u2019ve reached the limit of workflows in your plan"})}),(0,s.jsx)(K.B,{children:o({id:"Settings.review-workflows.list.page.workflows.limit.body",defaultMessage:"Delete a workflow or contact Sales to enable more workflows."})})]})]})]})}function Y(){const o=(0,E.useSelector)(m.s);return(0,s.jsx)(e.CheckPagePermissions,{permissions:o.settings["review-workflows"].main,children:(0,s.jsx)(J,{})})}},62128:(v,M,t)=>{t.d(M,{u:()=>D});var s=t(75937),e=t(30956),E=t(56892),m=t(40829);function D(){const{get:g}=(0,e.useFetchClient)(),{formatAPIError:l}=(0,e.useAPIErrorHandler)(),d=(0,e.useNotification)(),f=(0,m.useQueries)([{queryKey:["content-manager","components"],async queryFn(){const{data:{data:a}}=await g("/content-manager/components");return a},onError(a){a instanceof E.d7&&d({type:"warning",message:l(a)})}},{queryKey:["content-manager","content-types"],async queryFn(){const{data:{data:a}}=await g("/content-manager/content-types");return a},onError(a){a instanceof E.d7&&d({type:"warning",message:l(a)})}}]),[n,c]=f,_=n.isLoading||c.isLoading,i=s.useMemo(()=>(c?.data??[]).filter(a=>a.kind==="collectionType"&&a.isDisplayed),[c?.data]),P=s.useMemo(()=>(c?.data??[]).filter(a=>a.kind!=="collectionType"&&a.isDisplayed),[c?.data]);return{isLoading:_,components:s.useMemo(()=>n?.data??[],[n?.data]),collectionTypes:i,singleTypes:P}}},63037:(v,M,t)=>{t.d(M,{u:()=>m});var s=t(75937),e=t(30956),E=t(40829);function m(D={}){const{get:g}=(0,e.useFetchClient)(),{id:l="",...d}=D,f={populate:"stages"},{data:n,isLoading:c,status:_,refetch:i}=(0,E.useQuery)(["review-workflows","workflows",l],async()=>(await g(`/admin/review-workflows/workflows/${l}`,{params:{...f,...d}})).data),P=s.useMemo(()=>l&&n?.data?[n.data]:Array.isArray(n?.data)?n.data:[],[n?.data,l]);return{meta:s.useMemo(()=>n?.meta??{},[n?.meta]),workflows:P,isLoading:c,status:_,refetch:i}}},95207:(v,M,t)=>{t.d(M,{c:()=>f});var s=t(56940),e=t(19681),E=t(65094),m=t(43669),D=t(66041),g=t(74065);const l=(0,e.default)(E.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:n})=>n.colors.primary600};
  }
`,d=(0,e.default)(E.x)`
  border-radius: 0 0 ${({theme:n})=>n.borderRadius} ${({theme:n})=>n.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,f=({children:n,icon:c,..._})=>(0,s.jsxs)("div",{children:[(0,s.jsx)(m.i,{}),(0,s.jsx)(d,{as:"button",background:"primary100",padding:5,..._,children:(0,s.jsxs)(D.k,{children:[(0,s.jsx)(l,{"aria-hidden":!0,background:"primary200",children:c}),(0,s.jsx)(E.x,{paddingLeft:3,children:(0,s.jsx)(g.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:n})})]})})]})},56892:(v,M,t)=>{t.d(M,{d7:()=>E});var s=t(50646);const{Axios:e,AxiosError:E,CanceledError:m,isCancel:D,CancelToken:g,VERSION:l,all:d,Cancel:f,isAxiosError:n,spread:c,toFormData:_,AxiosHeaders:i,HttpStatusCode:P,formToJSON:a,getAdapter:L,mergeConfig:T}=s.default}}]);
